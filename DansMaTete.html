<!DOCTYPE html>



<html lang="fr">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>IA Bidirectionnelle - Apprentissage Mutuel</title>

    <style>

        * {

            margin: 0;

            padding: 0;

            box-sizing: border-box;

        }

    body {

        font-family: 'Arial', sans-serif;

        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);

        min-height: 100vh;

        display: flex;

        justify-content: center;

        align-items: center;

        padding: 20px;

    }



    .game-container {

        background: rgba(255, 255, 255, 0.95);

        border-radius: 20px;

        padding: 30px;

        max-width: 1000px;

        width: 100%;

        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);

        backdrop-filter: blur(10px);

        text-align: center;

    }



    .ai-brain {

        width: 140px;

        height: 140px;

        margin: 0 auto 20px;

        background: linear-gradient(45deg, #667eea, #764ba2, #f093fb);

        border-radius: 50%;

        display: flex;

        align-items: center;

        justify-content: center;

        font-size: 70px;

        animation: aiPulse 3s infinite;

        position: relative;

        box-shadow: 0 0 40px rgba(102, 126, 234, 0.4);

    }



    @keyframes aiPulse {

        0%, 100% { transform: scale(1); }

        50% { transform: scale(1.05); }

    }



    h1 {

        color: #1a1a2e;

        margin-bottom: 10px;

        font-size: 2.5em;

        background: linear-gradient(45deg, #667eea, #764ba2);

        -webkit-background-clip: text;

        -webkit-text-fill-color: transparent;

    }



    .subtitle {

        color: #666;

        margin-bottom: 30px;

        font-size: 1.2em;

    }



    .mode-selector {

        display: grid;

        grid-template-columns: 1fr 1fr;

        gap: 20px;

        margin: 30px 0;

    }



    .mode-button {

        padding: 25px;

        border: none;

        border-radius: 15px;

        cursor: pointer;

        transition: all 0.3s ease;

        font-weight: bold;

        font-size: 1.2em;

        color: white;

        background: linear-gradient(45deg, #667eea, #764ba2);

    }



    .mode-button:hover {

        transform: translateY(-5px);

        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);

    }



    .mode-ai-guesses {

        background: linear-gradient(45deg, #3498db, #2980b9);

    }



    .mode-human-guesses {

        background: linear-gradient(45deg, #e74c3c, #c0392b);

    }



    .debug-panel {

        background: #2c3e50;

        color: #ecf0f1;

        border-radius: 10px;

        padding: 15px;

        margin: 20px 0;

        text-align: left;

        font-family: 'Courier New', monospace;

        font-size: 0.9em;

        max-height: 200px;

        overflow-y: auto;

        border: 2px solid #34495e;

    }



    .debug-toggle {

        background: #34495e;

        color: white;

        border: none;

        padding: 10px 20px;

        border-radius: 25px;

        cursor: pointer;

        margin: 10px 0;

        font-size: 0.9em;

    }



    .game-area {

        background: #f8f9fa;

        border-radius: 15px;

        padding: 25px;

        margin: 20px 0;

        min-height: 400px;

    }



    .question-container {

        background: white;

        border-radius: 10px;

        padding: 20px;

        margin: 15px 0;

        border-left: 5px solid #667eea;

    }



    .question-input {

        width: 100%;

        padding: 15px;

        border: 2px solid #667eea;

        border-radius: 25px;

        font-size: 1.1em;

        margin: 10px 0;

        outline: none;

    }



    .question-input:focus {

        border-color: #f093fb;

        box-shadow: 0 0 10px rgba(240, 147, 251, 0.3);

    }



    .buttons {

        display: grid;

        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));

        gap: 15px;

        margin: 20px 0;

    }



    button {

        padding: 15px 25px;

        font-size: 1.1em;

        border: none;

        border-radius: 50px;

        cursor: pointer;

        transition: all 0.3s ease;

        font-weight: bold;

        min-height: 60px;

    }



    .yes-btn {

        background: linear-gradient(45deg, #27ae60, #2ecc71);

        color: white;

    }



    .no-btn {

        background: linear-gradient(45deg, #e74c3c, #c0392b);

        color: white;

    }



    .send-btn {

        background: linear-gradient(45deg, #3498db, #2980b9);

        color: white;

    }



    .restart-btn {

        background: linear-gradient(45deg, #f39c12, #e67e22);

        color: white;

    }



    .back-btn {

        background: linear-gradient(45deg, #95a5a6, #7f8c8d);

        color: white;

    }



    button:hover {

        transform: translateY(-3px);

        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);

    }



    .game-status {

        background: linear-gradient(135deg, #e8f6f3, #f0f8f5);

        border-radius: 10px;

        padding: 15px;

        margin: 15px 0;

        color: #2d5a2d;

        border-left: 4px solid #27ae60;

    }



    .reveal-btn {

        background: linear-gradient(45deg, #ff6b6b, #ee5a52);

        color: white;

        margin: 0 10px;

        padding: 10px 20px;

        font-size: 1em;

    }



    .ai-secret-panel {

        background: linear-gradient(135deg, #fff3cd, #fef9e7);

        border-radius: 12px;

        padding: 15px;

        margin: 15px 0;

        color: #856404;

        border-left: 4px solid #ffc107;

        font-size: 1.1em;

        font-weight: bold;

    }



    .ai-reasoning {

        background: linear-gradient(135deg, #e1f5fe, #f3e5f5);

        border-radius: 12px;

        padding: 20px;

        margin: 15px 0;

        color: #1a237e;

        border-left: 4px solid #3f51b5;

        text-align: left;

        font-family: 'Courier New', monospace;

        font-size: 0.95em;

    }



    .reasoning-step {

        background: rgba(255, 255, 255, 0.7);

        border-radius: 8px;

        padding: 10px;

        margin: 8px 0;

        border-left: 3px solid #4caf50;

    }



    .secret-revealed {

        background: linear-gradient(135deg, #ffebee, #fce4ec);

        border-left: 4px solid #e91e63;

        animation: reveal 0.5s ease-in-out;

    }



    @keyframes reveal {

        0% { opacity: 0; transform: scale(0.9); }

        100% { opacity: 1; transform: scale(1); }

    }



    .chat-history {

        max-height: 300px;

        overflow-y: auto;

        background: white;

        border-radius: 10px;

        padding: 15px;

        margin: 15px 0;

        text-align: left;

    }



    .chat-message {

        margin: 10px 0;

        padding: 10px;

        border-radius: 8px;

    }



    .human-message {

        background: #e3f2fd;

        border-left: 4px solid #2196f3;

    }



    .ai-message {

        background: #f3e5f5;

        border-left: 4px solid #9c27b0;

    }



    .instructions {

        background: linear-gradient(135deg, #e8f4f8, #f0f9ff);

        border-radius: 15px;

        padding: 25px;

        margin: 20px 0;

        color: #1a1a2e;

        line-height: 1.7;

        text-align: left;

    }



    .hidden {

        display: none;

    }



    .thinking-indicator {

        display: inline-block;

        animation: thinking 1.5s infinite;

    }



    @keyframes thinking {

        0%, 20% { opacity: 0; }

        50% { opacity: 1; }

        100% { opacity: 0; }

    }



    @media (max-width: 768px) {

        .mode-selector {

            grid-template-columns: 1fr;

        }

        

        .game-container {

            padding: 20px;

            margin: 10px;

        }

    }

</style>

</head>

<body>

    <div class="game-container">

        <div class="ai-brain">üß†</div>

    <!-- √âCRAN DE S√âLECTION DU MODE -->

    <div id="mode-selection" class="mode-selection">

        <h1>IA Bidirectionnelle</h1>

        <p class="subtitle">Apprentissage mutuel par inversion des r√¥les</p>

        

        <div class="instructions">

            <h3>üéØ R√©volution de l'apprentissage :</h3>

            <ul style="margin-left: 20px; margin-top: 10px;">

                <li><strong>Mode 1 - L'IA devine :</strong> Vous pensez √† quelque chose, l'IA pose des questions</li>

                <li><strong>Mode 2 - Vous devinez :</strong> L'IA pense √† quelque chose, vous posez des questions</li>

                <li><strong>Apprentissage mutuel :</strong> L'IA apprend de votre fa√ßon de questionner</li>

                <li><strong>Interface de debug :</strong> Analysez le processus de r√©flexion en temps r√©el</li>

                <li><strong>Am√©lioration continue :</strong> L'IA s'am√©liore √† chaque partie</li>

            </ul>

        </div>



        <button class="debug-toggle" onclick="toggleDebug()">üîß Activer/D√©sactiver le Mode Debug</button>

        

        <div class="mode-selector">

            <button class="mode-button mode-ai-guesses" onclick="startAIGuessing()">

                ü§ñ L'IA DEVINE<br>

                <small>Je pense √† quelque chose</small>

            </button>

            <button class="mode-button mode-human-guesses" onclick="startHumanGuessing()">

                üß† JE DEVINE<br>

                <small>L'IA pense √† quelque chose</small>

            </button>

        </div>

    </div>



    <!-- MODE: L'IA DEVINE -->

    <div id="ai-guessing-mode" class="hidden">

        <h1>ü§ñ L'IA tente de deviner</h1>

        <button class="back-btn" onclick="backToModeSelection()">‚Üê Retour</button>

        

        <div class="game-status" id="ai-game-status">

            üéØ Pensez √† quelque chose de pr√©cis. L'IA va vous poser des questions.

        </div>

        

        <div class="question-container">

            <div id="ai-question" style="font-size: 1.3em; margin-bottom: 20px;">

                Pr√™t ? Cliquez sur "Commencer" pour que l'IA commence √† deviner !

            </div>

            <div class="buttons" id="ai-answer-buttons">

                <button class="send-btn" onclick="startAIQuestioning()">Commencer</button>

            </div>

        </div>

    </div>



    <!-- MODE: VOUS DEVINEZ -->

    <div id="human-guessing-mode" class="hidden">

        <h1>üß† Essayez de deviner</h1>

        <button class="back-btn" onclick="backToModeSelection()">‚Üê Retour</button>

        

        <div class="game-status" id="human-game-status">

            üéØ L'IA a choisi quelque chose. Posez-lui des questions !

            <div style="margin-top: 10px;">

                <button class="reveal-btn" onclick="revealSecret()">üëÅÔ∏è R√âV√âLER LE SECRET</button>

                <button class="debug-toggle" onclick="toggleRealTimeDebug()">üîç R√©flexion Temps R√©el</button>

            </div>

        </div>

        

        <div class="ai-secret-panel" id="ai-secret-panel">

            ü§ñ L'IA pense √† : <span class="thinking-indicator" id="secret-display">...</span>

        </div>

        

        <div class="ai-reasoning" id="ai-reasoning" style="display: none;">

            <strong>üß† R√©flexion de l'IA en temps r√©el :</strong>

            <div id="reasoning-content">En attente de votre premi√®re question...</div>

        </div>

        

        <div class="question-container">

            <input type="text" class="question-input" id="human-question" 

                   placeholder="Tapez votre question ici... (ex: Est-ce que c'est vivant ?)"

                   onkeypress="handleQuestionKeyPress(event)">

            <div class="buttons">

                <button class="send-btn" onclick="askAI()">Envoyer la question</button>

                <button class="restart-btn" onclick="resetHumanGuessing()">Nouvelle partie</button>

            </div>

        </div>

        

        <div class="chat-history" id="chat-history">

            <strong>üí¨ Historique des questions :</strong>

            <div id="chat-messages"></div>

        </div>

    </div>



    <!-- PANNEAU DE DEBUG (visible dans les deux modes) -->

    <div id="debug-panel" class="debug-panel hidden">

        <strong>üîß DEBUG - Analyse en temps r√©el :</strong>

        <div id="debug-content">Initialisation du syst√®me de debug...</div>

    </div>

    

    <!-- PANNEAU DE CONNAISSANCES IA (visible dans les deux modes) -->

    <div id="ai-knowledge-panel" class="ai-knowledge hidden">

        <strong>üß† Connaissances IA acquises :</strong>

        <div id="knowledge-content">Aucune connaissance encore acquise...</div>

    </div>

</div>



<script>

    // SYST√àME BIDIRECTIONNEL AVEC APPRENTISSAGE MUTUEL

    class BidirectionalAI {

        constructor() {

            this.mode = null; // 'ai-guesses' ou 'human-guesses'

            this.debugMode = false;

            this.aiKnowledge = new Map();

            this.questionHistory = [];

            this.currentSecret = null;

            this.aiQuestionCount = 0;

            this.humanQuestionCount = 0;

            this.learnedPatterns = [];

            

            // Base de donn√©es des secrets que l'IA peut choisir

            this.aiSecrets = [

                { item: "chat", category: "animal", characteristics: ["vivant", "domestique", "4_pattes", "poils", "miaule"] },

                { item: "voiture", category: "objet", characteristics: ["artificiel", "transport", "roues", "m√©tal", "moteur"] },

                { item: "ordinateur", category: "objet", characteristics: ["√©lectronique", "√©cran", "travail", "clavier", "artificiel"] },

                { item: "arbre", category: "vivant", characteristics: ["vivant", "grand", "nature", "feuilles", "bois"] },

                { item: "t√©l√©phone", category: "objet", characteristics: ["√©lectronique", "portable", "communication", "√©cran", "artificiel"] },

                { item: "chien", category: "animal", characteristics: ["vivant", "domestique", "4_pattes", "poils", "aboie"] },

                { item: "avion", category: "objet", characteristics: ["artificiel", "transport", "vole", "grand", "m√©tal"] },

                { item: "livre", category: "objet", characteristics: ["artificiel", "papier", "lire", "rectangulaire", "l√©ger"] }

            ];

        }



        // MODE: L'IA DEVINE

        startAIGuessing() {

            this.mode = 'ai-guesses';

            this.aiQuestionCount = 0;

            this.aiKnowledge.clear();

            this.questionHistory = [];

            this.debugLog("üéØ Mode IA-devine activ√©. L'IA va apprendre √† mieux questionner.");

        }



        generateAIQuestion() {

            this.aiQuestionCount++;

            

            // Questions bas√©es sur l'apprentissage des patterns humains

            if (this.aiQuestionCount === 1) {

                return "Est-ce que c'est quelque chose de vivant ?";

            }

            

            if (this.aiQuestionCount === 2) {

                return "Est-ce que c'est plus grand qu'un livre ?";

            }

            

            if (this.aiQuestionCount === 3) {

                if (this.aiKnowledge.get('vivant') === true) {

                    return "Est-ce que c'est un animal ?";

                } else {

                    return "Est-ce que c'est fait par l'homme ?";

                }

            }

            

            // Questions plus sophistiqu√©es bas√©es sur les connaissances acquises

            return this.generateSmartAIQuestion();

        }



        generateSmartAIQuestion() {

            // Questions intelligentes bas√©es sur ce qui a √©t√© appris

            if (this.aiKnowledge.get('vivant') && this.aiKnowledge.get('animal')) {

                if (!this.aiKnowledge.has('domestique')) {

                    return "Est-ce que c'est un animal domestique ?";

                }

                if (!this.aiKnowledge.has('4_pattes')) {

                    return "Est-ce que √ßa a 4 pattes ?";

                }

                if (!this.aiKnowledge.has('miaule') && this.aiKnowledge.get('domestique')) {

                    return "Est-ce que √ßa miaule ?";

                }

            }

            

            if (!this.aiKnowledge.get('vivant')) {

                if (!this.aiKnowledge.has('√©lectronique')) {

                    return "Est-ce que c'est √©lectronique ?";

                }

                if (!this.aiKnowledge.has('transport')) {

                    return "Est-ce que √ßa sert au transport ?";

                }

            }

            

            return "Est-ce que c'est quelque chose de pr√©cieux ?";

        }



        processAIAnswer(answer) {

            let currentQuestion = document.getElementById('ai-question').textContent;

            let key = this.extractQuestionKey(currentQuestion);

            

            this.aiKnowledge.set(key, answer);

            this.questionHistory.push({ question: currentQuestion, answer: answer, asker: 'ai' });

            

            this.debugLog(`IA a appris: ${key} = ${answer}`);

            this.updateKnowledgeDisplay();

        }



        // MODE: VOUS DEVINEZ

        startHumanGuessing() {

            this.mode = 'human-guesses';

            this.humanQuestionCount = 0;

            this.questionHistory = [];

            this.realTimeDebug = false;

            

            // L'IA choisit un secret

            this.currentSecret = this.aiSecrets[Math.floor(Math.random() * this.aiSecrets.length)];

            this.debugLog(`ü§ñ L'IA a choisi: ${this.currentSecret.item}`);

            

            // Masquer le secret par d√©faut

            document.getElementById('secret-display').innerHTML = 

                '<span class="thinking-indicator">quelque chose...</span>';

            

            // Initialiser l'interface de r√©flexion

            this.updateReasoningDisplay("En attente de votre premi√®re question...");

        }



        processHumanQuestion(question) {

            this.humanQuestionCount++;

            let answer = this.generateAIAnswer(question);

            let reasoning = this.generateReasoning(question, answer);

            

            this.questionHistory.push({ 

                question: question, 

                answer: answer, 

                reasoning: reasoning,

                asker: 'human' 

            });

            

            this.analyzeLearningPattern(question, answer);

            this.debugLog(`Humain a demand√©: "${question}" ‚Üí R√©ponse: ${answer}`);

            

            // Mettre √† jour la r√©flexion en temps r√©el

            if (this.realTimeDebug) {

                this.updateReasoningDisplay(reasoning);

            }

            

            return answer;

        }



        generateReasoning(question, answer) {
            let secret = this.currentSecret;
            let reasoning = [];
            
            reasoning.push(`ü§î Question re√ßue: "${question}"`);
            reasoning.push(`üéØ Mon secret: ${secret.item} (${secret.category})`);
            reasoning.push(`üìã Mes caract√©ristiques: [${secret.characteristics.join(', ')}]`);
            reasoning.push(`---`);
            
            // NOUVEAU RAISONNEMENT CONTEXTUEL INTELLIGENT
            let q = question.toLowerCase();
            
            // V√©rification directe du nom
            if (q.includes(secret.item.toLowerCase())) {
                reasoning.push(`‚úÖ MATCH DIRECT: La question contient "${secret.item}"`);
                reasoning.push(`üí¨ R√©ponse automatique: OUI`);
                return reasoning.join('\n');
            }
            
            // Questions sur l'utilisation humaine
            if ((q.includes('humain') || q.includes('adulte') || q.includes('personne')) && 
                (q.includes('utilise') || q.includes('sert') || q.includes('avoir') || q.includes('peut'))) {
                
                reasoning.push(`üß† ANALYSE CONTEXTUELLE: Question sur l'utilisation par les humains`);
                
                if (secret.characteristics.includes('artificiel')) {
                    if (q.includes('ne') && (q.includes('sert pas') || q.includes('utilise pas'))) {
                        reasoning.push(`‚öñÔ∏è LOGIQUE: Question n√©gative d√©tect√©e ("ne sert pas")`);
                        reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} SERT aux humains`);
                        reasoning.push(`‚úÖ CONCLUSION: "ne sert pas" = FAUX ‚Üí R√©ponse: NON`);
                    } else {
                        reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} est artificiel ‚Üí Cr√©√© par/pour les humains`);
                        reasoning.push(`‚úÖ CONCLUSION: Les humains l'utilisent ‚Üí R√©ponse: OUI`);
                    }
                    reasoning.push(`üí¨ R√©ponse finale: ${answer.toUpperCase()}`);
                    return reasoning.join('\n');
                }
                
                if (secret.characteristics.includes('domestique')) {
                    reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} est domestique ‚Üí Vit avec les humains`);
                    reasoning.push(`‚úÖ CONCLUSION: Les humains peuvent l'avoir ‚Üí R√©ponse: OUI`);
                    reasoning.push(`üí¨ R√©ponse finale: ${answer.toUpperCase()}`);
                    return reasoning.join('\n');
                }
            }
            
            // Questions sur l'√¢ge/adulte
            if (q.includes('adulte') && (q.includes('avoir') || q.includes('peut'))) {
                reasoning.push(`üß† ANALYSE: Question sur la possession par un adulte`);
                if (secret.characteristics.includes('artificiel')) {
                    reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} est un objet artificiel`);
                    reasoning.push(`‚úÖ CONCLUSION: Un adulte peut le poss√©der/acheter ‚Üí R√©ponse: OUI`);
                } else if (secret.characteristics.includes('domestique')) {
                    reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} est un animal domestique`);
                    reasoning.push(`‚úÖ CONCLUSION: Un adulte peut l'adopter ‚Üí R√©ponse: OUI`);
                } else {
                    reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} n'est ni un objet ni domestique`);
                    reasoning.push(`‚ùå CONCLUSION: Difficile √† "poss√©der" ‚Üí R√©ponse: NON`);
                }
                reasoning.push(`üí¨ R√©ponse finale: ${answer.toUpperCase()}`);
                return reasoning.join('\n');
            }
            
            // Questions sur l'utilit√©
            if (q.includes('sert') || q.includes('utile') || q.includes('utilise')) {
                reasoning.push(`üß† ANALYSE: Question sur l'utilit√©/fonction`);
                if (secret.characteristics.includes('√©lectronique')) {
                    reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} est √©lectronique ‚Üí Outil technologique`);
                    reasoning.push(`‚úÖ CONCLUSION: Tr√®s utile dans la vie moderne ‚Üí R√©ponse: OUI`);
                } else if (secret.characteristics.includes('transport')) {
                    reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} sert au transport`);
                    reasoning.push(`‚úÖ CONCLUSION: Fonction essentielle ‚Üí R√©ponse: OUI`);
                } else if (secret.characteristics.includes('lire')) {
                    reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} sert √† lire/apprendre`);
                    reasoning.push(`‚úÖ CONCLUSION: Outil √©ducatif ‚Üí R√©ponse: OUI`);
                } else if (secret.category === 'animal' && secret.characteristics.includes('domestique')) {
                    reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} est un compagnon domestique`);
                    reasoning.push(`‚úÖ CONCLUSION: Utile pour la compagnie ‚Üí R√©ponse: OUI`);
                } else {
                    reasoning.push(`üîç RAISONNEMENT: Un ${secret.item} n'a pas d'utilit√© directe √©vidente`);
                    reasoning.push(`‚ùå CONCLUSION: Pas vraiment "utile" au sens pratique ‚Üí R√©ponse: NON`);
                }
                reasoning.push(`üí¨ R√©ponse finale: ${answer.toUpperCase()}`);
                return reasoning.join('\n');
            }
            
            // ANALYSE CLASSIQUE (fallback pour les autres questions)
            reasoning.push(`üîç ANALYSE CLASSIQUE par mots-cl√©s:`);
            let matchedCharacteristic = null;
            
            if (q.includes('vivant')) {
                matchedCharacteristic = 'vivant';
                reasoning.push(`üîç Mot-cl√© d√©tect√©: "vivant" ‚Üí Je cherche '${matchedCharacteristic}' dans mes caract√©ristiques`);
            } else if (q.includes('animal')) {
                reasoning.push(`üîç Mot-cl√© d√©tect√©: "animal" ‚Üí Je v√©rifie si ma cat√©gorie est 'animal'`);
            } else if (q.includes('grand') || q.includes('gros')) {
                matchedCharacteristic = 'grand';
                reasoning.push(`üîç Mot-cl√© d√©tect√©: "grand/gros" ‚Üí Je cherche '${matchedCharacteristic}' dans mes caract√©ristiques`);
            } else if (q.includes('domestique')) {
                matchedCharacteristic = 'domestique';
                reasoning.push(`üîç Mot-cl√© d√©tect√©: "domestique" ‚Üí Je cherche '${matchedCharacteristic}'`);
            } else if (q.includes('pattes')) {
                matchedCharacteristic = '4_pattes';
                reasoning.push(`üîç Mot-cl√© d√©tect√©: "pattes" ‚Üí Je cherche '${matchedCharacteristic}'`);
            } else if (q.includes('√©lectronique')) {
                matchedCharacteristic = '√©lectronique';
                reasoning.push(`üîç Mot-cl√© d√©tect√©: "√©lectronique" ‚Üí Je cherche '${matchedCharacteristic}'`);
            } else {
                reasoning.push(`‚ùì Aucun mot-cl√© reconnu ‚Üí Je r√©ponds par d√©faut 'non'`);
            }
            
            // Logique de d√©cision pour les mots-cl√©s
            if (matchedCharacteristic) {
                let hasCharacteristic = secret.characteristics.includes(matchedCharacteristic);
                reasoning.push(`‚úÖ V√©rification: ${matchedCharacteristic} ${hasCharacteristic ? 'TROUV√â' : 'NON TROUV√â'} dans mes caract√©ristiques`);
                reasoning.push(`üí¨ R√©ponse: ${hasCharacteristic ? 'OUI' : 'NON'}`);
            } else if (q.includes('animal')) {
                let isAnimal = secret.category === 'animal';
                reasoning.push(`‚úÖ V√©rification: Ma cat√©gorie est '${secret.category}' ${isAnimal ? '‚Üí OUI' : '‚Üí NON'}`);
            } else {
                reasoning.push(`‚ùå Aucune correspondance ‚Üí R√©ponse par d√©faut: NON`);
            }
            
            reasoning.push(`üé≤ Difficult√© estim√©e: ${this.estimateDifficulty(question)}/5`);
            
            return reasoning.join('\n');
        }



        estimateDifficulty(question) {

            let q = question.toLowerCase();

            if (q.includes('vivant') || q.includes('grand')) return 1; // Tr√®s facile

            if (q.includes('animal') || q.includes('objet')) return 2; // Facile

            if (q.includes('domestique') || q.includes('√©lectronique')) return 3; // Moyen

            if (q.includes('pattes') || q.includes('roues')) return 4; // Difficile

            if (q.includes('miaule') || q.includes('aboie')) return 5; // Tr√®s difficile

            return 3; // Par d√©faut

        }



        updateReasoningDisplay(reasoning) {

            if (this.realTimeDebug) {

                let reasoningContent = document.getElementById('reasoning-content');

                reasoningContent.innerHTML = reasoning.replace(/\n/g, '<br>');

                

                // Auto-scroll

                let reasoningDiv = document.getElementById('ai-reasoning');

                reasoningDiv.scrollTop = reasoningDiv.scrollHeight;

            }

        }



        generateAIAnswer(question) {
            let q = question.toLowerCase();
            let secret = this.currentSecret;
            
            // V√©rifications directes du nom de l'objet
            if (q.includes(secret.item.toLowerCase())) {
                return 'oui';
            }
            
            // LOGIQUE AM√âLIOR√âE POUR LES QUESTIONS CONTEXTUELLES
            
            // Questions sur l'utilisation par les humains
            if ((q.includes('humain') || q.includes('adulte') || q.includes('personne') || q.includes('gens')) && 
                (q.includes('utilise') || q.includes('sert') || q.includes('avoir') || q.includes('poss√®de') || q.includes('peut'))) {
                
                // Les objets artificiels sont g√©n√©ralement utilis√©s par les humains
                if (secret.characteristics.includes('artificiel')) {
                    // Questions n√©gatives
                    if (q.includes('ne') && (q.includes('sert pas') || q.includes('utilise pas'))) {
                        return 'non'; // "√ßa ne sert pas aux humains" ‚Üí NON pour un ordinateur
                    }
                    return 'oui'; // "un humain peut l'avoir" ‚Üí OUI pour un ordinateur
                }
                
                // Les animaux domestiques peuvent √™tre "poss√©d√©s" par les humains
                if (secret.characteristics.includes('domestique')) {
                    return 'oui';
                }
                
                // Les animaux sauvages ou plantes ne sont pas "poss√©d√©s"
                if (secret.category === 'animal' && !secret.characteristics.includes('domestique')) {
                    return 'non';
                }
                if (secret.category === 'vivant' && secret.item === 'arbre') {
                    return 'non'; // Difficile de "poss√©der" un arbre
                }
                
                return 'oui'; // Par d√©faut, most objets peuvent √™tre utilis√©s
            }
            
            // Questions sur l'√¢ge/adulte
            if (q.includes('adulte') && (q.includes('avoir') || q.includes('utilise') || q.includes('peut'))) {
                if (secret.characteristics.includes('artificiel')) {
                    return 'oui'; // Un adulte peut avoir un ordinateur, une voiture, etc.
                }
                if (secret.characteristics.includes('domestique')) {
                    return 'oui'; // Un adulte peut avoir un chat, un chien
                }
                return 'non';
            }
            
            // Questions sur l'utilit√©/fonction
            if (q.includes('sert') || q.includes('utile') || q.includes('utilise')) {
                if (secret.characteristics.includes('transport')) {
                    return 'oui'; // Une voiture/avion sert au transport
                }
                if (secret.characteristics.includes('√©lectronique')) {
                    return 'oui'; // Un ordinateur/t√©l√©phone est utile
                }
                if (secret.characteristics.includes('lire')) {
                    return 'oui'; // Un livre sert √† lire
                }
                if (secret.category === 'animal' && secret.characteristics.includes('domestique')) {
                    return 'oui'; // Les animaux domestiques sont utiles (compagnie)
                }
                return 'non';
            }
            
            // Questions sur la propri√©t√©/possession
            if (q.includes('appartient') || q.includes('propri√©t√©') || q.includes('poss√®de')) {
                if (secret.characteristics.includes('artificiel') && !secret.characteristics.includes('grand')) {
                    return 'oui'; // On peut poss√©der un ordinateur, t√©l√©phone, livre
                }
                if (secret.characteristics.includes('domestique')) {
                    return 'oui'; // On peut poss√©der un animal domestique
                }
                return 'non';
            }
            
            // Questions sur la maison/int√©rieur
            if (q.includes('maison') || q.includes('int√©rieur') || q.includes('dedans')) {
                if (secret.item === 'ordinateur' || secret.item === 't√©l√©phone' || secret.item === 'livre') {
                    return 'oui';
                }
                if (secret.characteristics.includes('domestique')) {
                    return 'oui'; // Chat/chien vivent dans la maison
                }
                if (secret.item === 'voiture' || secret.item === 'avion' || secret.item === 'arbre') {
                    return 'non';
                }
            }
            
            // Questions sur l'ext√©rieur
            if (q.includes('dehors') || q.includes('ext√©rieur')) {
                if (secret.item === 'voiture' || secret.item === 'avion' || secret.item === 'arbre') {
                    return 'oui';
                }
                if (secret.item === 'ordinateur' || secret.item === 't√©l√©phone' || secret.item === 'livre') {
                    return 'non';
                }
                if (secret.characteristics.includes('domestique')) {
                    return 'oui'; // Les animaux peuvent sortir
                }
            }
            
            // Logique de r√©ponse bas√©e sur les caract√©ristiques (code existant)
            if (q.includes('vivant')) {
                return secret.characteristics.includes('vivant') ? 'oui' : 'non';
            }
            if (q.includes('animal')) {
                return secret.category === 'animal' ? 'oui' : 'non';
            }
            if (q.includes('objet')) {
                return secret.category === 'objet' ? 'oui' : 'non';
            }
            if (q.includes('grand') || q.includes('gros')) {
                return secret.characteristics.includes('grand') ? 'oui' : 'non';
            }
            if (q.includes('petit')) {
                return !secret.characteristics.includes('grand') ? 'oui' : 'non';
            }
            
            // V√©rifications pour "fabriqu√©" ou "artificiel"
            if (q.includes('fabriqu√©') || q.includes('fabrique') || q.includes('artificiel') || (q.includes('fait') && q.includes('homme'))) {
                return secret.characteristics.includes('artificiel') ? 'oui' : 'non';
            }
            if (q.includes('naturel')) {
                return !secret.characteristics.includes('artificiel') ? 'oui' : 'non';
            }
            
            if (q.includes('domestique')) {
                return secret.characteristics.includes('domestique') ? 'oui' : 'non';
            }
            if (q.includes('sauvage')) {
                return !secret.characteristics.includes('domestique') && secret.category === 'animal' ? 'oui' : 'non';
            }
            if (q.includes('pattes')) {
                return secret.characteristics.includes('4_pattes') ? 'oui' : 'non';
            }
            if (q.includes('miaule')) {
                return secret.characteristics.includes('miaule') ? 'oui' : 'non';
            }
            if (q.includes('aboie')) {
                return secret.characteristics.includes('aboie') ? 'oui' : 'non';
            }
            if (q.includes('√©lectronique') || q.includes('electronique')) {
                return secret.characteristics.includes('√©lectronique') ? 'oui' : 'non';
            }
            if (q.includes('transport') || q.includes('d√©place') || q.includes('bouge')) {
                return secret.characteristics.includes('transport') ? 'oui' : 'non';
            }
            if (q.includes('roues')) {
                return secret.characteristics.includes('roues') ? 'oui' : 'non';
            }
            if (q.includes('vole') || q.includes('vol')) {
                return secret.characteristics.includes('vole') ? 'oui' : 'non';
            }
            if (q.includes('m√©tal') || q.includes('metal')) {
                return secret.characteristics.includes('m√©tal') ? 'oui' : 'non';
            }
            if (q.includes('moteur')) {
                return secret.characteristics.includes('moteur') ? 'oui' : 'non';
            }
            if (q.includes('papier')) {
                return secret.characteristics.includes('papier') ? 'oui' : 'non';
            }
            if (q.includes('√©cran') || q.includes('ecran')) {
                return secret.characteristics.includes('√©cran') ? 'oui' : 'non';
            }
            if (q.includes('communication') || q.includes('communiquer')) {
                return secret.characteristics.includes('communication') ? 'oui' : 'non';
            }
            if (q.includes('portable')) {
                return secret.characteristics.includes('portable') ? 'oui' : 'non';
            }
            if (q.includes('poils') || q.includes('poil')) {
                return secret.characteristics.includes('poils') ? 'oui' : 'non';
            }
            if (q.includes('feuilles') || q.includes('feuille')) {
                return secret.characteristics.includes('feuilles') ? 'oui' : 'non';
            }
            if (q.includes('bois')) {
                return secret.characteristics.includes('bois') ? 'oui' : 'non';
            }
            if (q.includes('nature')) {
                return secret.characteristics.includes('nature') ? 'oui' : 'non';
            }
            if (q.includes('rectangulaire')) {
                return secret.characteristics.includes('rectangulaire') ? 'oui' : 'non';
            }
            if (q.includes('l√©ger') || q.includes('leger')) {
                return secret.characteristics.includes('l√©ger') ? 'oui' : 'non';
            }
            if (q.includes('lourd')) {
                return !secret.characteristics.includes('l√©ger') ? 'oui' : 'non';
            }
            if (q.includes('lire') || q.includes('lecture')) {
                return secret.characteristics.includes('lire') ? 'oui' : 'non';
            }
            if (q.includes('travail') || q.includes('travaille')) {
                return secret.characteristics.includes('travail') ? 'oui' : 'non';
            }
            if (q.includes('clavier')) {
                return secret.characteristics.includes('clavier') ? 'oui' : 'non';
            }
            
            // R√©ponse par d√©faut
            return 'non';
        }



        analyzeLearningPattern(question, answer) {

            // Analyser les patterns de questionnement humain pour am√©liorer l'IA

            let pattern = {

                questionType: this.categorizeQuestion(question),

                questionNumber: this.humanQuestionCount,

                answer: answer,

                context: this.currentSecret.category

            };

            

            this.learnedPatterns.push(pattern);

            this.debugLog(`Pattern appris: ${pattern.questionType} au tour ${pattern.questionNumber}`);

        }



        categorizeQuestion(question) {

            let q = question.toLowerCase();

            if (q.includes('vivant')) return 'existence';

            if (q.includes('animal') || q.includes('plante')) return 'category_living';

            if (q.includes('grand') || q.includes('petit') || q.includes('taille')) return 'size';

            if (q.includes('couleur')) return 'appearance';

            if (q.includes('domestique') || q.includes('sauvage')) return 'domestication';

            if (q.includes('pattes') || q.includes('ailes')) return 'body_parts';

            if (q.includes('son') || q.includes('bruit') || q.includes('miaule') || q.includes('aboie')) return 'sounds';

            if (q.includes('√©lectronique') || q.includes('technologie')) return 'technology';

            if (q.includes('transport') || q.includes('d√©place')) return 'function_transport';

            if (q.includes('maison') || q.includes('dehors')) return 'location';

            return 'other';

        }



        extractQuestionKey(question) {

            let q = question.toLowerCase();

            if (q.includes('vivant')) return 'vivant';

            if (q.includes('animal')) return 'animal';

            if (q.includes('grand')) return 'grand';

            if (q.includes('homme') || q.includes('fait')) return 'artificiel';

            if (q.includes('domestique')) return 'domestique';

            if (q.includes('pattes')) return '4_pattes';

            if (q.includes('miaule')) return 'miaule';

            if (q.includes('aboie')) return 'aboie';

            if (q.includes('√©lectronique')) return '√©lectronique';

            if (q.includes('transport')) return 'transport';

            return 'autre';

        }



        debugLog(message) {

            if (this.debugMode) {

                let debugContent = document.getElementById('debug-content');

                let timestamp = new Date().toLocaleTimeString();

                debugContent.innerHTML += `<br>[${timestamp}] ${message}`;

                debugContent.scrollTop = debugContent.scrollHeight;

            }

        }



        updateKnowledgeDisplay() {

            if (this.debugMode) {

                let knowledge = '';

                for (let [key, value] of this.aiKnowledge) {

                    knowledge += `${key}: ${value}, `;

                }

                document.getElementById('knowledge-content').textContent = 

                    knowledge || 'Aucune connaissance encore acquise...';

            }

        }

    }



    let bidirectionalAI = new BidirectionalAI();



    // FONCTIONS DE NAVIGATION

    function toggleDebug() {

        bidirectionalAI.debugMode = !bidirectionalAI.debugMode;

        let debugPanel = document.getElementById('debug-panel');

        let knowledgePanel = document.getElementById('ai-knowledge-panel');

        

        if (bidirectionalAI.debugMode) {

            debugPanel.classList.remove('hidden');

            knowledgePanel.classList.remove('hidden');

            bidirectionalAI.debugLog("üîß Mode debug activ√©");

        } else {

            debugPanel.classList.add('hidden');

            knowledgePanel.classList.add('hidden');

        }

    }



    function startAIGuessing() {

        bidirectionalAI.startAIGuessing();

        document.getElementById('mode-selection').classList.add('hidden');

        document.getElementById('ai-guessing-mode').classList.remove('hidden');

    }



    function startHumanGuessing() {

        bidirectionalAI.startHumanGuessing();

        document.getElementById('mode-selection').classList.add('hidden');

        document.getElementById('human-guessing-mode').classList.remove('hidden');

    }



    function backToModeSelection() {

        document.getElementById('ai-guessing-mode').classList.add('hidden');

        document.getElementById('human-guessing-mode').classList.add('hidden');

        document.getElementById('mode-selection').classList.remove('hidden');

    }



    // FONCTIONS MODE IA-DEVINE

    function startAIQuestioning() {

        let question = bidirectionalAI.generateAIQuestion();

        document.getElementById('ai-question').textContent = question;

        document.getElementById('ai-answer-buttons').innerHTML = `

            <button class="yes-btn" onclick="answerAI(true)">OUI</button>

            <button class="no-btn" onclick="answerAI(false)">NON</button>

            <button class="restart-btn" onclick="resetAIGuessing()">Restart</button>

        `;

    }



    function answerAI(answer) {

        bidirectionalAI.processAIAnswer(answer);

        

        // Continuer avec la prochaine question

        setTimeout(() => {

            if (bidirectionalAI.aiQuestionCount < 10) {

                let nextQuestion = bidirectionalAI.generateAIQuestion();

                document.getElementById('ai-question').textContent = nextQuestion;

            } else {

                document.getElementById('ai-question').textContent = 

                    "J'ai pos√© 10 questions. Pouvez-vous me dire ce que c'√©tait pour que j'apprenne ?";

                document.getElementById('ai-answer-buttons').innerHTML = `

                    <button class="restart-btn" onclick="resetAIGuessing()">Nouvelle partie</button>

                `;

            }

        }, 1000);

    }



    function resetAIGuessing() {

        bidirectionalAI.startAIGuessing();

        document.getElementById('ai-question').textContent = 

            "Pr√™t ? Cliquez sur \"Commencer\" pour que l'IA commence √† deviner !";

        document.getElementById('ai-answer-buttons').innerHTML = `

            <button class="send-btn" onclick="startAIQuestioning()">Commencer</button>

        `;

    }



    // FONCTIONS MODE HUMAIN-DEVINE

    function handleQuestionKeyPress(event) {

        if (event.key === 'Enter') {

            askAI();

        }

    }



    function askAI() {
        let questionInput = document.getElementById('human-question');
        let question = questionInput.value.trim();
        
        if (!question) {
            alert('Veuillez taper une question !');
            return;
        }
        
        let answer = bidirectionalAI.processHumanQuestion(question);
        
        // V√©rifier si le joueur a trouv√© la bonne r√©ponse
        let isCorrectGuess = checkIfCorrectGuess(question, bidirectionalAI.currentSecret);
        
        // Ajouter √† l'historique
        let chatMessages = document.getElementById('chat-messages');
        chatMessages.innerHTML += `
            <div class="chat-message human-message">
                <strong>Vous:</strong> ${question}
            </div>
            <div class="chat-message ai-message">
                <strong>IA:</strong> ${answer.toUpperCase()}
            </div>
        `;
        
        // Si le joueur a trouv√©, afficher la victoire
        if (isCorrectGuess) {
            showVictoryMessage(bidirectionalAI.currentSecret, bidirectionalAI.humanQuestionCount);
            return;
        }
        
        // Vider le champ de saisie
        questionInput.value = '';
        questionInput.focus();
        
        // Faire d√©filer vers le bas
        let chatHistory = document.getElementById('chat-history');
        chatHistory.scrollTop = chatHistory.scrollHeight;
    }

    // FONCTIONS DE D√âTECTION ET AFFICHAGE DE VICTOIRE
    function checkIfCorrectGuess(question, secret) {
        let q = question.toLowerCase();
        let secretItem = secret.item.toLowerCase();
        
        // V√©rifications directes du nom
        if (q.includes(secretItem)) {
            return true;
        }
        
        // V√©rifications avec variations possibles
        if (q.includes('tu penses √†') && q.includes(secretItem)) {
            return true;
        }
        if (q.includes('est-ce') && q.includes(secretItem)) {
            return true;
        }
        if (q.includes('c\'est') && q.includes(secretItem)) {
            return true;
        }
        
        // V√©rifications avec articles
        if (q.includes('un ' + secretItem) || q.includes('une ' + secretItem)) {
            return true;
        }
        if (q.includes('le ' + secretItem) || q.includes('la ' + secretItem)) {
            return true;
        }
        
        return false;
    }

    function showVictoryMessage(secret, questionCount) {
        // Masquer l'interface de jeu
        document.getElementById('human-question').style.display = 'none';
        document.querySelector('.buttons').style.display = 'none';
        
        // Afficher le message de victoire
        let chatMessages = document.getElementById('chat-messages');
        chatMessages.innerHTML += `
            <div class="chat-message ai-message" style="background: linear-gradient(135deg, #d4edda, #c3e6cb); border-left: 4px solid #28a745; animation: reveal 0.5s ease-in-out;">
                <strong>üéâ BRAVO ! üéâ</strong><br>
                <strong>Vous avez trouv√© !</strong> Je pensais effectivement √† <strong style="color: #28a745;">${secret.item}</strong> !<br>
                <em>Vous avez r√©ussi en ${questionCount} questions seulement !</em><br><br>
                üìä <strong>Caract√©ristiques :</strong> ${secret.characteristics.join(', ')}<br>
                üè∑Ô∏è <strong>Cat√©gorie :</strong> ${secret.category}
            </div>
        `;
        
        // R√©v√©ler automatiquement le secret dans le panneau
        let secretDisplay = document.getElementById('secret-display');
        let secretPanel = document.getElementById('ai-secret-panel');
        secretDisplay.innerHTML = `<strong style="color: #28a745;">‚úÖ ${secret.item}</strong>`;
        secretPanel.classList.add('secret-revealed');
        
        // Afficher les boutons de fin de partie
        let gameStatus = document.getElementById('human-game-status');
        gameStatus.innerHTML = `
            <div style="text-align: center; margin: 20px 0;">
                <h2 style="color: #28a745; margin-bottom: 15px;">üèÜ VICTOIRE ! üèÜ</h2>
                <p style="font-size: 1.2em; margin-bottom: 20px;">
                    F√©licitations ! Vous avez devin√© <strong>${secret.item}</strong> en ${questionCount} questions !
                </p>
                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                    <button class="restart-btn" onclick="resetHumanGuessing()" style="font-size: 1.1em; padding: 15px 30px;">
                        üîÑ Nouvelle Partie
                    </button>
                    <button class="back-btn" onclick="backToModeSelection()" style="font-size: 1.1em; padding: 15px 30px;">
                        üè† Menu Principal
                    </button>
                </div>
            </div>
        `;
        
        // Faire d√©filer vers le bas pour voir le message
        let chatHistory = document.getElementById('chat-history');
        chatHistory.scrollTop = chatHistory.scrollHeight;
        
        // Ajouter un effet sonore virtuel avec animation
        setTimeout(() => {
            gameStatus.style.transform = 'scale(1.05)';
            setTimeout(() => {
                gameStatus.style.transform = 'scale(1)';
            }, 200);
        }, 100);
    }

    function resetHumanGuessing() {
        // R√©initialiser le jeu
        bidirectionalAI.startHumanGuessing();
        
        // Restaurer l'interface de jeu
        document.getElementById('human-question').style.display = 'block';
        document.querySelector('.buttons').style.display = 'grid';
        document.getElementById('human-question').value = '';
        document.getElementById('human-question').focus();
        
        // R√©initialiser l'historique des messages
        document.getElementById('chat-messages').innerHTML = '';
        
        // Restaurer le statut de jeu original
        document.getElementById('human-game-status').innerHTML = `
            üéØ L'IA a choisi quelque chose. Posez-lui des questions !
            <div style="margin-top: 10px;">
                <button class="reveal-btn" onclick="revealSecret()">üëÅÔ∏è R√âV√âLER LE SECRET</button>
                <button class="debug-toggle" onclick="toggleRealTimeDebug()">ÔøΩÔøΩ R√©flexion Temps R√©el</button>
            </div>
        `;
        
        // R√©initialiser le panneau secret
        let secretPanel = document.getElementById('ai-secret-panel');
        secretPanel.classList.remove('secret-revealed');
        
        // R√©initialiser la r√©flexion temps r√©el si elle √©tait active
        if (bidirectionalAI.realTimeDebug) {
            bidirectionalAI.updateReasoningDisplay("Mode r√©flexion temps r√©el activ√© ! Posez une question pour voir...");
        }
    }

    // NOUVELLES FONCTIONS POUR R√âV√âLATION ET DEBUG TEMPS R√âEL
    function revealSecret() {
        let secretPanel = document.getElementById('ai-secret-panel');
        let secretDisplay = document.getElementById('secret-display');
        
        secretDisplay.innerHTML = `<strong style="color: #d32f2f;">${bidirectionalAI.currentSecret.item}</strong>`;
        secretPanel.classList.add('secret-revealed');
        
        // Afficher aussi les caract√©ristiques
        let characteristics = bidirectionalAI.currentSecret.characteristics.join(', ');
        secretDisplay.innerHTML += `<br><small>Caract√©ristiques: ${characteristics}</small>`;
        
        // D√©sactiver le bouton
        event.target.disabled = true;
        event.target.textContent = "‚úÖ SECRET R√âV√âL√â";
        event.target.style.opacity = "0.6";
    }

    function toggleRealTimeDebug() {
        bidirectionalAI.realTimeDebug = !bidirectionalAI.realTimeDebug;
        let reasoningDiv = document.getElementById('ai-reasoning');
        
        if (bidirectionalAI.realTimeDebug) {
            reasoningDiv.style.display = 'block';
            event.target.textContent = "üîç Masquer R√©flexion";
            event.target.style.background = "linear-gradient(45deg, #4caf50, #388e3c)";
            bidirectionalAI.updateReasoningDisplay("Mode r√©flexion temps r√©el activ√© ! Posez une question pour voir...");
        } else {
            reasoningDiv.style.display = 'none';
            event.target.textContent = "üîç R√©flexion Temps R√©el";
            event.target.style.background = "linear-gradient(45deg, #34495e, #2c3e50)";
        }
    }

</script>

</body>
</html>